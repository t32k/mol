---
layout: post
title: JavaScript 第5版 11章 正規表現パターンマッチング
categories:
- javascript
tags:
- sai5
status: publish
type: post
published: true
meta:
  blogger_blog: warikiru.blogspot.com
  blogger_author: t32khttp://www.blogger.com/profile/06797489791220082722noreply@blogger.com
  blogger_permalink: /2009/07/pattern-matching-with-regular.html
  _edit_last: '1'
  pvc_views: '8838'
---
StringとRegExpクラスで正規表現パターンが使える


<h2>11.1　正規表現の定義</h2>
RegExpオブジェクトはコンストラクタでも生成できるが特殊なリテラル形式でも生成可能
スラッシュ(/)で囲んで記述
<pre><code>var pattern = /s$/;</code></pre>
最後が「s」という英字の任意の文字列に一致する
コンストラクタでかくとこうなる↓
<pre><code>var pattern = new RegExp("s$");</code></pre>
JSはPerlの正規表現を採用

<h3>11.1.1　リテラル文字</h3>
正規表現では英数字はそのまま使われる
バックスラッシュ（\）でエスケープシーケンスの形式で英数字以外の文字もサポート

正規表現のリテラル文字
<pre><code>\t　　タブ
\n　　改行</code></pre>
以下の句読点文字は正規表現中では特別な意味をもつ
<pre><code>^ $ . * + ? = ! : | \ / () [] {}</code></pre>
どの句読点文字をエスケープしなければならないかわからないときは句読点文字の前には常に\を付加すればいい
\をエスケープしたいときは\を使う
<pre><code>/\\/</code></pre>

<h3>11.1.2　文字クラス</h3>
個々のリテラル文字を角括弧（[]）で囲むことで、文字クラスにまとめられる
括弧内の船乙にカレット（^）を指定すると
ハイフン（-）を使って文字の範囲を指定

正規表現の文字クラス
<pre><code>[...]　　角括弧内の任意の１文字
[^...]　 角括弧内も文字以外の任意の１文字
.　　　　改行以外の文字。[^\n]と同じ
\w　　　 任意の単語文字（word character）　[a-zA-Z0-9_]と同じ
\W　　　 ASCII文字での単語文字以外の文字　[^a-zA-Z0-9_]と同じ
\s　　 　任意のUnicode空白文字
\S　　 　Unicode空白以外の文字。　\wと\Sは違う
\d　　 　任意の数字。　[0-9]と同じ
\D　　 　数字以外の文字。[^0-9]と同じ
[\b]　　リテラルバックスペース（特殊なケース）</code></pre>

<h3>11.1.3　繰り返し</h3>
正規表現の繰り返し文字
<pre><code>{n,m}   直前の項目をn回からm回まで繰り返す
  {n,}　　直前の項目をn回以上繰り返す
  {n}　　 直前の項目をn回だけ繰り返す
  ?　　　 直前の項目をゼロ回または1回だけ繰り返す。　{0,1}と同じ
  +　　　 直前の項目を1回以上繰り返す {1,}と同じ
  *　　　 直前の項目をゼロ回以上繰り返す　{0,}と同じ</code></pre>
*や?を使うときは注意。０個の繰り返しに一致するので、空文字列にも一致する

<strong>非貪欲な繰り返し</strong>
繰り返し文字は正規表現の残りの部分が一致する限りできるだけくりかえす。
これを『貪欲な繰り返し』という。　繰り返し文字のあとに?をつけることで非貪欲な繰り返しになる

<h3>11.1.4　選択、グループ化、参照</h3>
選択は左から右に比較が行われる
括弧（()）は部分表現にまとめる、または部分パターンを定義
<pre><code>|　　　　　 選択。この記号の左右どちらかに一致する
(...)　　　グループ化。このグループに一致する文字を記憶しておいて後で参照できるようにする
(?:...)　  グループ化のみ。記憶しない
\n　　　　  グループ番号nで指定された部分表現に一致した文字列に一致する</code></pre>

<h3>11.1.5　一致位置の指定</h3>
<strong>アンカー</strong>：検索対象の文字列の中で特定の位置にパターンを固定する要素

正規表現のアンカー文字
<pre><code>^　　　　文字列の先頭
$　　　　文字列の最後
\b　　　 単語境界
\B　　　 単語境界ではない位置
(?=p)　  先読み言明
(?!p)　　否先読み言明</code></pre>

<h3>11.1.6　フラグ</h3>
正規表現のフラグ
<pre><code>i　　　大文字、小文字を区別しない
g　　　グローバル検索
m　　　マルチラインモードにする</code></pre>

<h3>11.1.7　JavaScriptでサポートされないPerlの正規表現機能</h3>
ECMAScript v3仕様では、Perl5の正規表現の基本機能をほぼすべてサポート
一部のPerlの正規表現の高度な機能はサポートされていない


<h2>11.2　パターンマッチング用の文字列メソッド</h2>
Stringオブジェクトには正規表現を使用するメソッドが4つある
search()メソッド
最初に見つけた文字列の先頭の文字位置を示す番号を返す。
見つからなかった場合は-1を返す
下記例の場合、4が返される
<pre><code>"JavaScript".search(/script/i);</code></pre>
replace()メソッド
指定されたパターンに一致する文字列を検索し、指定された文字列に置き換える
<pre><code>//大文字と小文字の使い方が統一されてなくてもすべて「JavaScript」に統一する
text.replace(/javascript/gi, "JavaScript");</code></pre>
match()メソッド
引数に正規表現を指定すると、一致した結果を格納した配列が返される
<pre><code>"1 plus 2 equals 3".match(/\d+/g)  //実行結果は["1", "2", "3"]</code></pre>
spilt()メソッド
指定された引数を区切り文字としてしようし、文字列をいくつかに分割する
<pre><code>"123,456,789".spilt(",");  // 実行結果は["123", "456", "789"]</code></pre>


<h2>11.3　RegExpオブジェクト</h2>
RegExpオブジェクトは3つのメソッドと多数のプロパティをサポート
正規表現を文字列リテラルとしてRegExp()コンストラクタに渡す場合、
「\」を「\\」に置き換える必要がある
RegExp()コンストラクタの便利なっては正規表現を動的に生成できること
<pre><code>//文字列から5桁の数字をすべて検索する
var zipcode = new RegExp("\\d{5}","g")</code></pre>

<h3>11.3.1　パターンマッチング用のRegExpメソッド</h3>
exec()メソッド
指定された文字列に対して正規表現による検索を実行
一致する文字列が見つかった場合、配列を返し、見つからない場合nullを返す
match()メソッドとよく似ている

test()メソッド
引数に指定された文字列がパターンに指定された正規表現とマッチすればtureを返す
<pre><code>var pattern = "/java/i";pattern.test("JavaScript"); // 結果はtrue</code></pre>

<h3>11.3.2　RegExpインスタンスプロパティ</h3>
RegExpオブジェクトには5つのプロパティがある
<ul>
  <li>sourceプロパティ 正規表現の本体である文字列を格納する。読み出し専用</li>
  <li>globalプロパティ 正規表現にgフラグが設定されているかどうか論理値を格納する。読み出し専用</li>
  <li>ignoreCaseプロパティ　正規表現にiフラグが設定されているかどうか論理値を格納する。読み出し専用</li>
  <li>multilineプロパティ 正規表現にmフラグが設定されているかどうか論理値を格納する。読み出し専用</li>
  <li>lastIndexプロパティ  次に検索を開始する文字位置を示す整数を格納する。読み書き可能</li>
</ul>
